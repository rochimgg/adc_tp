%----------------------------------------------------------------------------------------
%	PACKAGES AND DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[10pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{siunitx} % Provides the \SI{}{} and \si{} command for typesetting SI units
\usepackage{graphicx} % Required for the inclusion of images
\graphicspath{ {images/} }
\usepackage{natbib} % Required to change bibliography style to APA
\usepackage{amsmath}
\usepackage{amsfonts, amssymb} %Required for some math elements
\usepackage{booktabs} %\toprule and tablas
\usepackage{hyperref}
\usepackage[sc]{mathpazo}
\usepackage{rotating}
\usepackage{gensymb}
\usepackage{cancel}
\usepackage{enumitem}
\usepackage{numprint}
\usepackage{float}
\usepackage{colortbl}
\usepackage[margin=0.7in]{geometry}
\usepackage{lipsum}% http://ctan.org/pkg/lipsum
\usepackage{fancyhdr}% http://ctan.org/pkg/fancyhdr
\usepackage[table,xcdraw]{xcolor}
%\setlength\parindent{0pt} % Removes all indentation from paragraphs
\renewcommand{\labelenumi}{\alph{enumi}.} % Make numbering in the enumerate environment by letter rather than number (e.g. section 6)

\usepackage{times} % Uncomment to use the Times New Roman font

\usepackage{authblk} % author package
\usepackage{unicode-math}
\usepackage[utf8]{inputenc}\DeclareUnicodeCharacter{2212}{-}
\renewcommand*{\Authand}{, } % para separar los autores por comas

\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}

\usepackage{makecell}%To keep spacing of text in tables
\setcellgapes{4pt}%parameter for the spacing


% to use tables visit http://www.tablesgenerator.com/latex_tables
\usepackage{multirow} % para usar multiples filas en una tabla

\setlength{\parindent}{0cm}

\input{step.pgf}
\input{impulse.pgf}
\input{bode_plot.pgf}
\input{sine_f0.pgf}
\input{sine_great_f0.pgf}
\input{sine_little_f0.pgf}
\input{square_10_times_f0.pgf}
\input{square_f0.pgf}
\input{square_f0_over_10.pgf}


%----------------------------------------------------------------------------------------
%	DOCUMENT INFORMATION
%----------------------------------------------------------------------------------------

\title{
Análisis de Circuitos - Trabajo Final \\
\large Modelado de un filtro a partir de su función transferencia \\
\textsc{\small}  Facultad de Ingeniería, Universidad de Buenos Aires}

\author{Rocío Gallo, padrón 97490 (rgallo@fi.uba.com)}


\date{\today} %Date for the report


\begin{document}

    \maketitle % Insert the title, author and date

    \section{Introducción}\label{sec:introducción}

    \section{Desarrollo}\label{sec:desarrollo}
    \subsection{Análisis de la Función Transferencia}\label{subsec:análisis-de-la-función-transferencia}
    La transferencia dada por la catedra es la siguiente:

    \[H(s)=\frac{0.8911 \cdot s^{4}}{s^4+2539 \cdot s^3 + 4.686 \cdot 10^{6} \cdot s^2 + 2.894 \cdot 10^{9} \cdot s + 2.863 \cdot 10^{12}}\] \\

    Puede verse que tanto el numerador como el denominador de la transferencia son ambos polinomios de cuatro grado.
    La transferencia tendrá cuatro polos y cuatro ceros
    Si se factoriza el denominador y se le hallan sus raices, se puede ver que los polos de la transferencia estan ubicados en dos pares de complejos conjugados de valores

    \begin{gather*}
        P_1 = -1136.16013946+1374.30962058j\\
        P_2 = -1136.16013946-1374.30962058j\\
        P_3 = -133.33986054 +939.49558151j\\
        P_4 = -133.33986054 -939.49558151j\\
    \end{gather*} \\

    Ahora si se remplaza el denominador con la factorizacion del mismo
    \[H(s)=\frac{0.8911 \cdot s^{4}}{(s + 1136.16 - 1374.31j) \cdot (s + 1136.166 + 1374.31j) \cdot (s +133.34 -939.496j) \cdot (s + 133.34 +939.496j)}\] \\
    y se acomoda la transferencia

    \[H(s)=\frac{0.8911 \cdot s^{2}}{(s + 1136.16 - 1374.31j) \cdot (s + 1136.166 + 1374.31j)} \cdot \frac{s^{2}}{(s +133.34 -939.496j) \cdot (s + 133.34 +939.496j)}\] \\

    Puede verse a la transferencia total como la multiplicacion de dos transferencias con polos y ceros de segundo orden.
    Como el sistema se enuentra en regimen transformado, esto se puede traducir de forma circuital como dos circuitos que representan cada una de las trasferencias parciales, conectadas en cascada.
    Estos filtros parciales, seran llamados de ahora en adelante como filtro de entrada $H_i(s)$ y filtro de salida $H_o(s)$

    \[ H(s) = H_{i}(s) \cdot H_{o}(s)\]

    \subsection{Análisis en frecuencia}\label{subsec:análisis-en-frecuencia}
    Si se analiza la función transferencia total a altas y bajas freciencias \\

    Si $s \rightarrow 0$
    \[\lim_{\omega \rightarrow 0}{H(s)} = 0 \]

    Si $\omega \rightarrow \infty$
    \[\lim_{\omega \rightarrow \infty}{H(j\omega)} = \frac{\infty}{\infty} \rightarrow \mbox{L'Hospital} \rightarrow \lim_{s \rightarrow \infty}{H(j\omega)} = 0.8911\] \\

    \subsection{Diagramas de Bode}\label{subsec:diagramas-de-bode}

    \subsection{Diagramas de Modulo}\label{subsec:diagramas-de-modulo}

    \subsection{Diagramas de Fase}\label{subsec:diagramas-de-fase}

    \subsection{Filtro Pasa Altos Multiple Feedback}\label{subsec:filtro-pasa-altos-multiple-feedback}

    Las dos instancias del filtro total (entrada y salida) serán implementadas con dos filtros pasa altos multiple feedback.
    La implementación de cada una de las instancias tendrá la forma

    % Aca va el grafico del filtro sin valores

    Donde la dependencia de la transferencia con cada uno de sus componentes pasivos es \\

    \[ H_{MF}(s) = \frac{-s^{2}\cdot \frac{C_{1}}{C_{3}}}{s^{2}+s \cdot \frac{C_{1}+C_{2}+C_{3}}{R_{2}\cdot C_{2} \cdot C_{3}} + \frac{1}{R_{1} \cdot R_{2} \cdot C_{2} \cdot C_{3}}} \] \\

    donde los terminos del denominador tienen la siguiente forma \\

    \[s^{2}+ \frac{\omega_{0}}{Q} \cdot s + \omega_{0}^{2} \] \\

    Como el filto a implementar tiene una ganancia menor a 1, los filtros intermedios tendrán ganancias negativas.
    De esta forma, entre los dos filtros las fases se sumarán por estar en cascada, por lo que la señal de salida tendrá una fase igual a $0$.

    En cuanto a la ganancia total del filtro final, la misma va a ser la multiplicacion de las ganancias parciales de cada uno de los filtros que lo componen.
    Las ganancias parciales fueron elegidas de forma tal que su multiplicacion se aproximara lo más posible a la ganancia requerida.

    \[ \frac{C_{1}^{i}}{C_{3}^{i}} \cdot \frac{C_{1}^{o}}{C_{3}^{o}} \approx  0.8911 \] \\

    Como la serie requerida para los capacitores es la del $10\%$, fueron buscados capacitores de serie E12.
    Haciendo cuentas \\

    \[ \frac{27nF}{100nF} \cdot \frac{33nF}{10nF} = 0.891 \approx  0.8911 \] \\

    Para conservar la ganancia total lo más parecida a la requerida con los valores normalizados, las ganancias parciales de cada uno de los filtros serán

    \begin{gather*}
        K_{i} = -0.27\\
        K_{o} = -3.3\\
    \end{gather*}

    \subsection{Filtro de Entrada}\label{subsec:filtro-de-entrada}

    \subsubsection{Filtro Teórico}

    El filtro de entrada tendra la siguiente funcion transferencia teórica \\

    \[H_{i}^{T}(s)=\frac{-0.27 \cdot s^{2}}{(s + 1136.16 - 1374.31j) \cdot (s + 1136.166 + 1374.31j)}\] \\

    acomodando para que quede en forma canonica

    \[H_i(s)=\frac{-0.27 \cdot s^{2}}{s^{2}+2072.32 \cdot s + 2962355.52}\] \\

    despejando a partir de la formula de polos de segundo orden

    \begin{gather*}
        \omega_{0}= \sqrt{2962355.52} = 1721.15 \, rad/s\\
        f_{0}= \frac{\omega_{0}}{2\pi} = 273.93 \, Hz\\
        Q= \frac{\omega_0}{2072.32} = 0.8305\\
    \end{gather*}

    \subsubsection{Filtro con valores normalizados}

    Tomando los siguientes valores para capacitores y resistores de serie $10\%$:
    $C_{1} = 27 \, nF$, $C_{2} = 330 \, nF$, $C_{3} = 100 \, nF$, $R_{1} = 1.5 \, k\Omega$ y $R_{2} = 6.8 \, k\Omega$; la transferencia real del filtro de entrada quedará de la siguiente forma

    \[H_{i}^{R}(s)=\frac{-0.27 \cdot s^{2}}{s^{2}+2036.54 \cdot s + 2970885.32}\] \\

    despejando a partir de la formula de polos de segundo orden

    \begin{gather*}
        \omega_{0}= \sqrt{2970885.32} = 1723.63 \, rad/s\\
        f_{0}= \frac{\omega_{0}}{2\pi} = 274.32 \, Hz\\
        Q= \frac{\omega_0}{2072.32} = 0.8463\\
    \end{gather*}

    \subsection{Filtro de Salida}\label{subsec:filtro-de-salida}

    \subsubsection{Filtro Teórico}
    El filtro de salida tendra la siguiente funcion transferencia teórica \\

    \[H_o(s)= \frac{-3.3 \cdot s^{2}}{(s +133.34 -939.496j) \cdot (s + 133.34 +939.496j)}\] \\

    acomodando para que quede en forma canonica

    \[H_{o}^{T}(s)=  \frac{-3.3 \cdot s^{2}}{s^{2}+266.68\cdot s + 900432.29}\] \\

    despejando a partir de la formula de polos de segundo orden

    \begin{gather*}
        \omega_{0}= \sqrt{900432.29} = 948.91 \, rad/s\\
        f_{0}= \frac{\omega_{0}}{2\pi} = 151.02 \, Hz\\
        Q= \frac{\omega_{0}}{266.68} = 3.56\\
    \end{gather*} \\

    \subsubsection{Filtro con valores normalizados}

    Tomando los siguientes valores para capacitores y resistores de serie $10\%$:
    $C_{1} = 33 \, nF$, $C_{2} = 180 \, nF$, $C_{3} = 10 \, nF$, $R_{1} = 1.2 \, k\Omega$ y $R_{2} = 470 \, k\Omega$; la transferencia real del filtro de entrada quedará de la siguiente forma

    \[H_{o}^{R}(s)=  \frac{-3.3 \cdot s^{2}}{s^{2}+263.59 \cdot s + 985027.58}\] \\

    despejando a partir de la formula de polos de segundo orden

    \begin{gather*}
        \omega_{0}= \sqrt{900432.29} = 992.49 \, rad/s\\
        f_{0}= \frac{\omega_{0}}{2\pi} = 157.96 \, Hz\\
        Q= \frac{\omega_{0}}{266.68} = 3.77\\
    \end{gather*} \\

    \section{Conclusión}\label{sec:conclusión}

\end{document}

